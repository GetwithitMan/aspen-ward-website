@import "tailwindcss";

/* Configure Tailwind v4 */
@theme {
  --font-sans: 'Plus Jakarta Sans', system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  --font-display: 'Playfair Display', 'Times New Roman', serif;

  --color-bg: var(--bg);
  --color-bg-alt: var(--bg-alt);
  --color-surface: var(--surface);
  --color-surface-muted: var(--surface-muted);
  --color-surface-soft: var(--surface-soft);
  --color-stroke: var(--stroke);
  --color-stroke-strong: var(--stroke-strong);
  --color-ink: var(--ink);
  --color-ink-soft: var(--ink-soft);
  --color-ink-muted: var(--ink-muted);
  --color-accent: var(--accent);
  --color-accent-strong: var(--accent-strong);
  --color-accent-soft: var(--accent-soft);
  --color-accent-contrast: var(--accent-contrast);
  --color-warning: var(--warning);

  --shadow-sm: var(--shadow-sm);
  --shadow-md: var(--shadow-md);
  --shadow-lg: var(--shadow-lg);

  --radius-sm: var(--radius-sm);
  --radius-md: var(--radius-md);
  --radius-lg: var(--radius-lg);

  --animate-scroll: scroll linear infinite;

  @keyframes scroll {
    0% { transform: translateX(100vw); }
    100% { transform: translateX(-100%); }
  }
}

/* CSS Custom Properties - Design Tokens */
@layer base {
  :root {
    color-scheme: light dark;
    font-family: 'Plus Jakarta Sans', system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
    font-size: 14px;
    --bg: #f9f5ef;
    --bg-alt: #f2e9dd;
    --surface: #ffffff;
    --surface-muted: #fff8f0;
    --surface-soft: rgba(255, 255, 255, 0.82);
    --stroke: rgba(61, 41, 21, 0.12);
    --stroke-strong: rgba(61, 41, 21, 0.18);
    --ink: #2f1c11;
    --ink-soft: rgba(47, 28, 17, 0.78);
    --ink-muted: rgba(47, 28, 17, 0.56);
    --accent: #7c3aed;
    --accent-strong: #5b21b6;
    --accent-soft: rgba(124, 58, 237, 0.18);
    --accent-contrast: #ffffff;
    --warning: #d97706;
    --shadow-lg: 0 28px 60px rgba(64, 41, 102, 0.14);
    --shadow-md: 0 18px 44px rgba(64, 41, 102, 0.12);
    --shadow-sm: 0 10px 28px rgba(64, 41, 102, 0.08);
    --radius-lg: 28px;
    --radius-md: 20px;
    --radius-sm: 14px;
    --transition: 180ms ease;
    --content-width: min(640px, 92vw);
    --header-height: 64px;
  }

  [data-theme="dark"] {
    --bg: #1b1624;
    --bg-alt: #251d32;
    --surface: rgba(31, 26, 37, 0.92);
    --surface-muted: rgba(44, 34, 58, 0.82);
    --surface-soft: rgba(31, 26, 37, 0.86);
    --stroke: rgba(233, 224, 255, 0.12);
    --stroke-strong: rgba(233, 224, 255, 0.18);
    --ink: #f5f3ff;
    --ink-soft: rgba(245, 243, 255, 0.82);
    --ink-muted: rgba(245, 243, 255, 0.6);
    --accent: #b8a4ff;
    --accent-strong: #9f87ff;
    --accent-soft: rgba(184, 164, 255, 0.22);
    --accent-contrast: #160f24;
    --shadow-lg: 0 32px 70px rgba(10, 6, 18, 0.6);
    --shadow-md: 0 22px 50px rgba(10, 6, 18, 0.48);
    --shadow-sm: 0 14px 32px rgba(10, 6, 18, 0.38);
  }

  html {
    scroll-behavior: smooth;
  }

  body {
    background: radial-gradient(circle at top left, var(--bg-alt), transparent 55%),
      linear-gradient(180deg, var(--bg) 0%, #fff 60%, var(--bg-alt) 100%);
    color: var(--ink);
    -webkit-font-smoothing: antialiased;
  }

  body::before {
    content: "";
    position: fixed;
    inset: 0;
    pointer-events: none;
    background-image: radial-gradient(rgba(124, 58, 237, 0.12) 1px, transparent 1px);
    background-size: 28px 28px;
    opacity: 0.35;
  }

  a {
    color: inherit;
    text-decoration: none;
    transition: color var(--transition), opacity var(--transition);
  }

  a:hover,
  a:focus-visible {
    color: var(--accent-strong);
  }

  a:focus-visible,
  button:focus-visible {
    outline: 3px solid var(--accent);
    outline-offset: 3px;
  }

  button {
    font: inherit;
    color: inherit;
    background: none;
    border: none;
    cursor: pointer;
  }

  img {
    max-width: 100%;
    display: block;
  }

  [hidden] {
    display: none !important;
  }
}

/* Component Classes */
@layer components {
  /* App Shell */
  .app-shell {
    @apply min-h-screen flex flex-col;
  }

  /* Header */
  .site-header {
    @apply sticky top-10 z-30 backdrop-blur-lg border-b;
    background: color-mix(in srgb, var(--surface-soft) 88%, transparent);
    border-color: var(--stroke);
  }

  .news-flash[hidden] + .app-shell .site-header {
    @apply top-0;
  }

  .header-shell {
    @apply w-full mx-auto flex items-center justify-between gap-3 py-3 relative z-2;
    max-width: var(--content-width);
    min-height: var(--header-height);
  }

  /* Brand */
  .brand {
    @apply inline-flex items-center gap-3 py-2 px-3 rounded-md border transition-all duration-200;
    background: var(--surface);
    border-color: var(--stroke);
    box-shadow: var(--shadow-sm);
  }

  .brand:hover {
    @apply -translate-y-px;
    box-shadow: var(--shadow-md);
  }

  .brand-icon {
    @apply w-10 h-10 rounded-full grid place-items-center text-lg tracking-wide;
    font-family: var(--font-display);
    background: linear-gradient(140deg, var(--accent), var(--accent-strong));
    color: var(--accent-contrast);
  }

  .brand-copy {
    @apply flex flex-col gap-0.5;
  }

  .brand-title {
    @apply text-xl tracking-tight;
    font-family: var(--font-display);
  }

  .brand-subtitle {
    @apply text-sm;
    color: var(--ink-muted);
  }

  /* Header Actions */
  .header-actions {
    @apply flex items-center gap-2 order-3 ml-3;
  }

  .theme-icon {
    @apply w-5 h-5 rounded-full;
    background: radial-gradient(circle at 30% 30%, var(--accent-contrast) 0%, var(--accent-contrast) 34%, transparent 60%),
      linear-gradient(140deg, var(--accent), var(--accent-strong));
    box-shadow: inset 0 -2px 4px rgba(0, 0, 0, 0.16);
  }

  [data-theme="dark"] .theme-icon {
    background: radial-gradient(circle at 70% 30%, rgba(22, 14, 33, 0.35) 0%, rgba(22, 14, 33, 0.35) 34%, transparent 58%),
      linear-gradient(140deg, var(--accent), var(--accent-strong));
    box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.25);
  }

  .theme-toggle {
    @apply w-11 h-11 rounded-full border grid place-items-center transition-all duration-200;
    background: var(--surface);
    border-color: var(--stroke);
    box-shadow: var(--shadow-sm);
  }

  .theme-toggle:hover {
    @apply -translate-y-px;
    box-shadow: var(--shadow-md);
  }

  /* Menu Toggle */
  .menu-toggle {
    @apply inline-flex items-center justify-center w-11 h-11 rounded-full border transition-all duration-200 relative;
    background: var(--surface);
    border-color: var(--stroke);
    box-shadow: var(--shadow-sm);
  }

  .menu-toggle:hover {
    @apply -translate-y-px;
    box-shadow: var(--shadow-md);
  }

  .menu-toggle::before,
  .menu-toggle::after {
    content: '';
    @apply absolute rounded-full transition-transform duration-200;
    width: 18px;
    height: 2px;
    background: var(--ink);
  }

  .menu-lines {
    @apply block absolute rounded-full transition-all duration-200 left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2;
    width: 18px;
    height: 2px;
    background: var(--ink);
  }

  .menu-toggle::before {
    @apply left-1/2 top-1/2;
    transform: translate(-50%, -6px);
  }

  .menu-toggle::after {
    @apply left-1/2 top-1/2;
    transform: translate(-50%, 6px);
  }

  .menu-toggle.open .menu-lines {
    @apply opacity-0;
  }

  .menu-toggle.open::before {
    transform: translate(-50%, -50%) rotate(45deg);
  }

  .menu-toggle.open::after {
    transform: translate(-50%, -50%) rotate(-45deg);
  }

  /* Navigation */
  .primary-nav {
    @apply absolute right-4 w-60 p-3 opacity-0 invisible -translate-y-2 transition-all duration-200 order-2 ml-auto z-10 pointer-events-none border;
    top: calc(100% + 0.75rem);
    max-width: calc(100vw - 2rem);
    background: var(--surface);
    border-color: var(--stroke-strong);
    border-radius: var(--radius-md);
    box-shadow: var(--shadow-lg);
  }

  .primary-nav.open {
    @apply opacity-100 visible translate-y-0 pointer-events-auto;
  }

  .nav-list {
    @apply list-none m-0 p-0 flex flex-col gap-2 items-stretch;
  }

  .nav-link {
    @apply flex items-center justify-between gap-2 py-2 px-3 font-semibold border border-transparent transition-all duration-200;
    color: var(--ink);
    border-radius: var(--radius-sm);
  }

  .nav-link:hover,
  .nav-link:focus-visible {
    background: var(--accent-soft);
    color: var(--accent-strong);
  }

  .nav-link.active {
    background: var(--accent-soft);
    border-color: color-mix(in srgb, var(--accent) 40%, transparent);
    color: var(--accent-strong);
  }

  /* Hero Section */
  .hero {
    padding: clamp(1.5rem, 7vw, 2.5rem) 0 1.5rem;
  }

  .hero-shell {
    @apply w-full mx-auto;
    max-width: var(--content-width);
  }

  .hero-card {
    @apply relative overflow-hidden border;
    border-radius: var(--radius-lg);
    padding: clamp(1.2rem, 4vw, 1.8rem);
    background: linear-gradient(145deg, color-mix(in srgb, var(--surface) 85%, transparent) 0%, var(--surface-muted) 100%);
    border-color: var(--stroke);
    box-shadow: var(--shadow-lg);
  }

  .hero-card::after {
    content: '';
    @apply absolute inset-0 pointer-events-none opacity-45;
    background: radial-gradient(circle at 20% 20%, rgba(124, 58, 237, 0.28), transparent 55%),
      radial-gradient(circle at 80% 30%, rgba(124, 58, 237, 0.16), transparent 60%);
  }

  .hero-card > * {
    @apply relative z-1;
  }

  .hero-badge {
    @apply inline-flex items-center gap-1 text-xs uppercase tracking-widest font-bold py-1 px-3 rounded-full;
    background: var(--accent-soft);
    color: var(--accent-strong);
  }

  .hero-title {
    @apply mt-2 mb-1 tracking-tight;
    font-family: var(--font-display);
    font-size: clamp(1.8rem, 6vw, 2.5rem);
  }

  .hero-subtitle {
    @apply m-0 text-base;
    max-width: 36ch;
    color: var(--ink-soft);
  }

  .hero-meta {
    @apply my-3 inline-flex items-center gap-2 py-2 px-4 border font-semibold;
    border-radius: var(--radius-sm);
    background: color-mix(in srgb, var(--surface) 72%, transparent);
    border-color: var(--stroke);
    color: var(--accent-strong);
    box-shadow: var(--shadow-sm);
  }

  .hero-actions {
    @apply flex flex-wrap gap-2;
  }

  /* Buttons */
  .btn {
    @apply inline-flex items-center justify-center gap-2 py-2 px-5 rounded-full font-semibold border border-transparent transition-all duration-200;
    background: linear-gradient(140deg, var(--accent), var(--accent-strong));
    color: var(--accent-contrast);
    box-shadow: var(--shadow-sm);
  }

  .btn:hover,
  .btn:focus-visible {
    @apply -translate-y-px;
    box-shadow: var(--shadow-md);
  }

  .btn.ghost {
    @apply bg-transparent;
    color: var(--accent-strong);
    border-color: color-mix(in srgb, var(--accent) 35%, transparent);
  }

  .btn.ghost:hover,
  .btn.ghost:focus-visible {
    background: var(--accent-soft);
  }

  .btn.full {
    @apply w-full;
  }

  /* Sections */
  .section {
    padding: clamp(1.5rem, 6vw, 2rem) 0;
  }

  .section-shell {
    @apply w-full mx-auto flex flex-col gap-4;
    max-width: var(--content-width);
  }

  .section-header {
    @apply flex flex-col gap-1;
  }

  .section-overline {
    @apply text-xs uppercase font-bold;
    letter-spacing: 0.18em;
    color: var(--accent-strong);
  }

  .section-title {
    @apply m-0;
    font-family: var(--font-display);
    font-size: clamp(1.6rem, 4.5vw, 2rem);
  }

  .section-intro {
    @apply m-0 text-sm;
    color: var(--ink-soft);
  }

  /* Program Grid */
  .program-grid {
    @apply flex flex-col gap-0.5;
  }

  .program-card {
    @apply grid items-baseline border;
    grid-template-columns: minmax(90px, auto) minmax(0, 1fr);
    column-gap: 0.3rem;
    row-gap: 0.1rem;
    padding: 0.2rem 0.4rem;
    background: var(--surface);
    border-color: var(--stroke);
    border-radius: var(--radius-sm);
    box-shadow: var(--shadow-sm);
  }

  .program-title {
    @apply m-0 font-semibold leading-tight break-words;
    font-size: 0.82rem;
    color: var(--ink);
  }

  .program-detail {
    @apply m-0 leading-snug break-words;
    font-size: 0.82rem;
    color: var(--ink-soft);
  }

  .program-detail a {
    @apply underline;
    color: var(--accent-strong);
  }

  .program-detail a:hover,
  .program-detail a:focus-visible {
    text-decoration-thickness: 2px;
  }

  .program-grid .error-text {
    @apply m-0;
  }

  /* Announcements */
  .announcements-list {
    @apply flex flex-col gap-2;
  }

  .announcement-card {
    @apply relative transition-all duration-200;
    background: var(--surface);
    border: 1px solid var(--stroke);
    border-radius: var(--radius-md);
    padding: 0.7rem 0.9rem;
    border-left: 4px solid var(--announcement-accent, var(--accent));
    box-shadow: var(--shadow-sm);
  }

  .announcement-card::after {
    content: '';
    @apply absolute inset-0 pointer-events-none opacity-0 transition-opacity duration-200;
    border-radius: inherit;
    border: 1px solid transparent;
    background: linear-gradient(
      120deg,
      color-mix(in srgb, var(--announcement-accent, var(--accent)) 22%, transparent),
      transparent 65%
    );
  }

  .announcement-card:hover,
  .announcement-card:focus-within {
    @apply -translate-y-0.5;
    box-shadow: var(--shadow-md);
  }

  .announcement-card:hover::after,
  .announcement-card:focus-within::after {
    @apply opacity-100;
  }

  .announcement-title {
    @apply m-0 text-base font-semibold;
    color: var(--ink);
  }

  .announcement-body {
    @apply mt-1 text-sm;
    color: var(--ink-soft);
  }

  .announcement-body a {
    @apply underline;
    color: var(--accent-strong);
  }

  .announcement-link {
    @apply inline-flex items-center gap-1 mt-2 text-sm font-semibold uppercase;
    letter-spacing: 0.04em;
    color: var(--accent-strong);
  }

  .announcement-link span {
    font-size: 0.95rem;
  }

  .announcement-link:hover,
  .announcement-link:focus-visible {
    @apply opacity-85;
    color: var(--accent-strong);
  }

  /* Events Timeline */
  .events-timeline {
    @apply flex flex-col gap-2;
  }

  .event-card {
    @apply flex flex-col gap-2 border transition-all duration-200;
    background: var(--surface);
    border-color: var(--stroke);
    border-radius: var(--radius-md);
    padding: 0.7rem 0.9rem;
    box-shadow: var(--shadow-sm);
  }

  .event-card:hover,
  .event-card:focus-within {
    @apply -translate-y-0.5;
    box-shadow: var(--shadow-md);
  }

  .event-header {
    @apply flex flex-col gap-1;
  }

  .event-date {
    @apply text-xs uppercase font-bold;
    letter-spacing: 0.16em;
    color: var(--ink-muted);
  }

  .event-title {
    @apply m-0 text-base font-semibold;
  }

  .event-body {
    @apply text-sm;
    color: var(--ink-soft);
  }

  .event-body a {
    @apply underline;
    color: var(--accent-strong);
  }

  .calendar-link {
    @apply self-start text-xs uppercase font-bold py-1.5 px-3 rounded-full border transition-all duration-200;
    letter-spacing: 0.12em;
    color: var(--accent-strong);
    border-color: color-mix(in srgb, var(--accent) 45%, transparent);
    background: var(--accent-soft);
  }

  .calendar-link:hover,
  .calendar-link:focus-visible {
    background: var(--accent);
    color: var(--accent-contrast);
  }

  /* Error Text */
  .error-text {
    @apply font-semibold text-center;
    background: color-mix(in srgb, var(--surface) 72%, var(--warning) 12%);
    border: 1px solid color-mix(in srgb, var(--warning) 45%, transparent);
    border-radius: var(--radius-sm);
    padding: 0.8rem;
    color: var(--warning);
  }

  /* Footer */
  .site-footer {
    @apply mt-auto py-8 px-6 text-center text-sm;
    color: var(--ink-muted);
  }

  .footer-note {
    @apply mt-2 text-sm italic;
    color: var(--ink-soft);
  }

  /* Modal */
  .modal {
    @apply fixed inset-0 flex items-center justify-center backdrop-blur-md p-4 z-100;
    background: rgba(16, 10, 27, 0.48);
  }

  .modal-card {
    @apply w-full flex flex-col gap-4 p-6 border;
    max-width: 420px;
    background: var(--surface);
    border-color: var(--stroke-strong);
    border-radius: var(--radius-lg);
    box-shadow: var(--shadow-lg);
  }

  .modal-header {
    @apply flex items-start justify-between gap-3;
  }

  .modal-title {
    @apply m-0 text-2xl;
    font-family: var(--font-display);
  }

  .modal-close {
    @apply w-9 h-9 rounded-full border relative;
    background: var(--surface-muted);
    border-color: var(--stroke);
  }

  .modal-close::before,
  .modal-close::after {
    content: '';
    @apply absolute top-1/2 left-1/2;
    width: 12px;
    height: 2px;
    background: var(--ink);
    transform-origin: center;
  }

  .modal-close::before {
    transform: translate(-50%, -50%) rotate(45deg);
  }

  .modal-close::after {
    transform: translate(-50%, -50%) rotate(-45deg);
  }

  .modal-body {
    @apply flex flex-col gap-3 text-sm;
    color: var(--ink-soft);
  }

  #banner-body > * {
    @apply border;
    background: color-mix(in srgb, var(--surface) 85%, var(--accent-soft));
    border-radius: var(--radius-sm);
    padding: 0.7rem 0.9rem;
    border-color: var(--stroke);
  }

  .modal-body .banner-title {
    @apply font-semibold mb-1;
    color: var(--ink);
  }

  #banner-body strong {
    color: var(--accent-strong);
  }

  #banner-body a {
    @apply underline;
    color: var(--accent-strong);
  }

  /* News Flash */
  .news-flash {
    @apply fixed top-0 left-0 w-full flex items-center justify-between py-2 z-40 overflow-hidden;
    padding-right: 2.5rem;
    padding-left: 1rem;
    background: linear-gradient(90deg, var(--accent), var(--accent-strong));
    color: var(--accent-contrast);
    box-shadow: var(--shadow-sm);
  }

  .news-flash-content {
    @apply whitespace-nowrap text-sm font-semibold inline-block animate-scroll;
    padding-right: 5rem;
  }

  .news-flash-close {
    @apply absolute top-1/2 -translate-y-1/2 w-7 h-7 rounded-full border grid place-items-center transition-transform duration-200;
    right: 0.5rem;
    background: var(--accent-contrast);
    border-color: var(--stroke);
  }

  .news-flash-close:hover,
  .news-flash-close:focus-visible {
    transform: translateY(-50%) scale(1.05);
    box-shadow: var(--shadow-md);
  }

  .news-flash-close-icon::before,
  .news-flash-close-icon::after {
    content: '';
    @apply absolute top-1/2 left-1/2;
    width: 10px;
    height: 2px;
    background: var(--ink);
    transform-origin: center;
  }

  .news-flash-close-icon::before {
    transform: translate(-50%, -50%) rotate(45deg);
  }

  .news-flash-close-icon::after {
    transform: translate(-50%, -50%) rotate(-45deg);
  }
}

/* Responsive Overrides */
@media (min-width: 640px) {
  .header-shell {
    @apply py-3;
  }

  .primary-nav {
    top: calc(100% + 0.8rem);
  }
}

@media (min-width: 768px) {
  .menu-toggle {
    @apply hidden;
  }

  .header-actions {
    @apply ml-3;
  }

  .primary-nav {
    @apply static w-auto p-0 bg-transparent border-none shadow-none opacity-100 visible translate-y-0 pointer-events-auto flex items-center;
  }

  .nav-list {
    @apply flex-row gap-2;
  }

  .nav-link {
    @apply py-2 px-4 rounded-full;
  }
}

@media (min-width: 880px) {
  .app-shell::after {
    content: '';
    @apply fixed pointer-events-none;
    right: 6vw;
    top: 18vh;
    width: 220px;
    height: 220px;
    background: radial-gradient(circle, rgba(124, 58, 237, 0.14), transparent 70%);
    filter: blur(0.5px);
  }

  .section-shell {
    @apply gap-5;
  }
}

@media (max-width: 540px) {
  .program-card {
    grid-template-columns: minmax(80px, auto) minmax(0, 1fr);
    padding: 0.18rem 0.35rem;
    column-gap: 0.3rem;
  }

  .program-title {
    font-size: 0.78rem;
  }

  .program-detail {
    font-size: 0.78rem;
  }
}
